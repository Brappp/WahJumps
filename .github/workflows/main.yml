name: Weekly CSV Update and Plugin Build

on:
  schedule:
    - cron: '0 0 * * 1'  # Runs at midnight UTC every Monday
  workflow_dispatch:      # This enables manual runs

jobs:
  update-csv-and-build:
    runs-on: windows-latest  

    steps:
      # Setup .NET 8.0 (or adjust if you use .NET 7.0)
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '8.0.x'  # Ensure this matches your project's target framework

      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Download CSVs
        run: |
          mkdir -p WahJumps/Data/CSV
          
          # NA Data Centers
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=82382952" -o WahJumps/Data/CSV/aether_cleaned.csv
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=1186977950" -o WahJumps/Data/CSV/primal_cleaned.csv
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=350373672" -o WahJumps/Data/CSV/crystal_cleaned.csv
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=1383994086" -o WahJumps/Data/CSV/dynamis_cleaned.csv
          
          # EU Data Centers
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=1339692877" -o WahJumps/Data/CSV/chaos_cleaned.csv
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=175977131" -o WahJumps/Data/CSV/light_cleaned.csv
          
          # OCE Data Center
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=874557131" -o WahJumps/Data/CSV/materia_cleaned.csv
          
          # JP Data Centers
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=1856583868" -o WahJumps/Data/CSV/elemental_cleaned.csv
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&gid=1822506732" -o WahJumps/Data/CSV/gaia_cleaned.csv
          curl -L "https://docs.google.com/spreadsheets/d/1DyOqqECaNuAEntBxwv2NQ7p5rTrC1tDN9hHpcI_PNs4/export?format=csv&
